[2025-12-15T19:23:11.215+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-12-15T19:23:11.244+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: weather_prediction_pipeline_v2.store_daily_predictions scheduled__2025-12-14T18:05:00+00:00 [queued]>
[2025-12-15T19:23:11.259+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: weather_prediction_pipeline_v2.store_daily_predictions scheduled__2025-12-14T18:05:00+00:00 [queued]>
[2025-12-15T19:23:11.260+0000] {taskinstance.py:2865} INFO - Starting attempt 1 of 3
[2025-12-15T19:23:11.278+0000] {taskinstance.py:2888} INFO - Executing <Task(PythonOperator): store_daily_predictions> on 2025-12-14 18:05:00+00:00
[2025-12-15T19:23:11.288+0000] {standard_task_runner.py:72} INFO - Started process 13370 to run task
[2025-12-15T19:23:11.296+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'weather_prediction_pipeline_v2', 'store_daily_predictions', 'scheduled__2025-12-14T18:05:00+00:00', '--job-id', '54', '--raw', '--subdir', 'DAGS_FOLDER/test_etl.py', '--cfg-path', '/tmp/tmp0zoskv_1']
[2025-12-15T19:23:11.303+0000] {standard_task_runner.py:105} INFO - Job 54: Subtask store_daily_predictions
[2025-12-15T19:23:11.344+0000] {logging_mixin.py:190} WARNING - /home/***/.local/lib/python3.10/site-packages/***/settings.py:209 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-12-15T19:23:11.449+0000] {task_command.py:467} INFO - Running <TaskInstance: weather_prediction_pipeline_v2.store_daily_predictions scheduled__2025-12-14T18:05:00+00:00 [running]> on host 89522446c9a4
[2025-12-15T19:23:11.454+0000] {logging_mixin.py:190} WARNING - /home/***/.local/lib/python3.10/site-packages/***/settings.py:470 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-12-15T19:23:11.590+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='ahmed_sami' AIRFLOW_CTX_DAG_ID='weather_prediction_pipeline_v2' AIRFLOW_CTX_TASK_ID='store_daily_predictions' AIRFLOW_CTX_EXECUTION_DATE='2025-12-14T18:05:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-12-14T18:05:00+00:00'
[2025-12-15T19:23:11.591+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-12-15T19:23:11.613+0000] {logging_mixin.py:190} INFO - ======================================================================
[2025-12-15T19:23:11.614+0000] {logging_mixin.py:190} INFO -                     DAY 2: STORING PREDICTIONS (BULK MODE)
[2025-12-15T19:23:11.615+0000] {logging_mixin.py:190} INFO - ======================================================================
[2025-12-15T19:23:11.640+0000] {logging_mixin.py:190} INFO - üíæ Storing 27 predictions using Bulk Insert...
[2025-12-15T19:23:11.658+0000] {base.py:84} INFO - Retrieving connection 'ml_con'
[2025-12-15T19:23:11.685+0000] {logging_mixin.py:190} INFO - ‚úÖ Stored 27 predictions successfully!
[2025-12-15T19:23:11.686+0000] {logging_mixin.py:190} INFO - ======================================================================
[2025-12-15T19:23:11.687+0000] {python.py:240} INFO - Done. Returned value was: None
[2025-12-15T19:23:11.704+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-12-15T19:23:11.706+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=weather_prediction_pipeline_v2, task_id=store_daily_predictions, run_id=scheduled__2025-12-14T18:05:00+00:00, execution_date=20251214T180500, start_date=20251215T192311, end_date=20251215T192311
[2025-12-15T19:23:11.752+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-12-15T19:23:11.779+0000] {taskinstance.py:3900} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-12-15T19:23:11.782+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
[2025-12-15T20:27:21.217+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-12-15T20:27:21.254+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: weather_prediction_pipeline_v2.store_daily_predictions scheduled__2025-12-14T18:05:00+00:00 [queued]>
[2025-12-15T20:27:21.268+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: weather_prediction_pipeline_v2.store_daily_predictions scheduled__2025-12-14T18:05:00+00:00 [queued]>
[2025-12-15T20:27:21.269+0000] {taskinstance.py:2865} INFO - Starting attempt 1 of 3
[2025-12-15T20:27:21.285+0000] {taskinstance.py:2888} INFO - Executing <Task(PythonOperator): store_daily_predictions> on 2025-12-14 18:05:00+00:00
[2025-12-15T20:27:21.295+0000] {standard_task_runner.py:72} INFO - Started process 17259 to run task
[2025-12-15T20:27:21.302+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'weather_prediction_pipeline_v2', 'store_daily_predictions', 'scheduled__2025-12-14T18:05:00+00:00', '--job-id', '78', '--raw', '--subdir', 'DAGS_FOLDER/test_etl.py', '--cfg-path', '/tmp/tmp0r9m1byt']
[2025-12-15T20:27:21.308+0000] {standard_task_runner.py:105} INFO - Job 78: Subtask store_daily_predictions
[2025-12-15T20:27:21.344+0000] {logging_mixin.py:190} WARNING - /home/***/.local/lib/python3.10/site-packages/***/settings.py:209 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-12-15T20:27:21.485+0000] {task_command.py:467} INFO - Running <TaskInstance: weather_prediction_pipeline_v2.store_daily_predictions scheduled__2025-12-14T18:05:00+00:00 [running]> on host 89522446c9a4
[2025-12-15T20:27:21.488+0000] {logging_mixin.py:190} WARNING - /home/***/.local/lib/python3.10/site-packages/***/settings.py:470 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-12-15T20:27:21.776+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='ahmed_sami' AIRFLOW_CTX_DAG_ID='weather_prediction_pipeline_v2' AIRFLOW_CTX_TASK_ID='store_daily_predictions' AIRFLOW_CTX_EXECUTION_DATE='2025-12-14T18:05:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-12-14T18:05:00+00:00'
[2025-12-15T20:27:21.780+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-12-15T20:27:21.826+0000] {logging_mixin.py:190} INFO - ======================================================================
[2025-12-15T20:27:21.828+0000] {logging_mixin.py:190} INFO -                     DAY 2: STORING PREDICTIONS (BULK MODE)
[2025-12-15T20:27:21.829+0000] {logging_mixin.py:190} INFO - ======================================================================
[2025-12-15T20:27:21.868+0000] {logging_mixin.py:190} INFO - üíæ Storing 27 predictions using Bulk Insert...
[2025-12-15T20:27:21.896+0000] {base.py:84} INFO - Retrieving connection 'ml_con'
[2025-12-15T20:27:41.661+0000] {local_task_job_runner.py:346} WARNING - State of this instance has been externally set to None. Terminating instance.
[2025-12-15T20:27:41.664+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
[2025-12-15T20:27:41.668+0000] {process_utils.py:132} INFO - Sending 15 to group 17259. PIDs of all processes in the group: [17259]
[2025-12-15T20:27:41.670+0000] {process_utils.py:87} INFO - Sending the signal 15 to group 17259
[2025-12-15T20:28:41.672+0000] {process_utils.py:150} WARNING - process psutil.Process(pid=17259, name='airflow task ru', status='sleeping', started='20:27:20') did not respond to SIGTERM. Trying SIGKILL
[2025-12-15T20:28:41.690+0000] {process_utils.py:87} INFO - Sending the signal 9 to group 17259
[2025-12-15T20:28:41.720+0000] {process_utils.py:80} INFO - Process psutil.Process(pid=17259, name='airflow task ru', status='terminated', exitcode=<Negsignal.SIGKILL: -9>, started='20:27:20') (17259) terminated with exit code -9
[2025-12-15T20:28:41.723+0000] {standard_task_runner.py:190} ERROR - ('Job 78 was killed before it finished (likely due to running out of memory)', 'For more information, see https://***.apache.org/docs/apache-***/stable/troubleshooting.html#LocalTaskJob-killed')
[2025-12-15T20:54:43.266+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-12-15T20:54:43.291+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: weather_prediction_pipeline_v2.store_daily_predictions scheduled__2025-12-14T18:05:00+00:00 [queued]>
[2025-12-15T20:54:43.300+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: weather_prediction_pipeline_v2.store_daily_predictions scheduled__2025-12-14T18:05:00+00:00 [queued]>
[2025-12-15T20:54:43.302+0000] {taskinstance.py:2865} INFO - Starting attempt 1 of 3
[2025-12-15T20:54:43.314+0000] {taskinstance.py:2888} INFO - Executing <Task(PythonOperator): store_daily_predictions> on 2025-12-14 18:05:00+00:00
[2025-12-15T20:54:43.323+0000] {standard_task_runner.py:72} INFO - Started process 19000 to run task
[2025-12-15T20:54:43.326+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'weather_prediction_pipeline_v2', 'store_daily_predictions', 'scheduled__2025-12-14T18:05:00+00:00', '--job-id', '90', '--raw', '--subdir', 'DAGS_FOLDER/test_etl.py', '--cfg-path', '/tmp/tmpwazxt9zx']
[2025-12-15T20:54:43.330+0000] {standard_task_runner.py:105} INFO - Job 90: Subtask store_daily_predictions
[2025-12-15T20:54:43.356+0000] {logging_mixin.py:190} WARNING - /home/***/.local/lib/python3.10/site-packages/***/settings.py:209 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-12-15T20:54:43.416+0000] {task_command.py:467} INFO - Running <TaskInstance: weather_prediction_pipeline_v2.store_daily_predictions scheduled__2025-12-14T18:05:00+00:00 [running]> on host 89522446c9a4
[2025-12-15T20:54:43.418+0000] {logging_mixin.py:190} WARNING - /home/***/.local/lib/python3.10/site-packages/***/settings.py:470 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-12-15T20:54:43.531+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='ahmed_sami' AIRFLOW_CTX_DAG_ID='weather_prediction_pipeline_v2' AIRFLOW_CTX_TASK_ID='store_daily_predictions' AIRFLOW_CTX_EXECUTION_DATE='2025-12-14T18:05:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-12-14T18:05:00+00:00'
[2025-12-15T20:54:43.534+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-12-15T20:54:43.555+0000] {logging_mixin.py:190} INFO - ======================================================================
[2025-12-15T20:54:43.556+0000] {logging_mixin.py:190} INFO -                     DAY 2: STORING PREDICTIONS (BULK MODE)
[2025-12-15T20:54:43.557+0000] {logging_mixin.py:190} INFO - ======================================================================
[2025-12-15T20:54:43.580+0000] {logging_mixin.py:190} INFO - üíæ Storing 27 predictions using Bulk Insert...
[2025-12-15T20:54:43.595+0000] {base.py:84} INFO - Retrieving connection 'ml_con'
[2025-12-15T21:06:26.532+0000] {local_task_job_runner.py:346} WARNING - State of this instance has been externally set to None. Terminating instance.
[2025-12-15T21:06:26.535+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
[2025-12-15T21:06:26.538+0000] {process_utils.py:132} INFO - Sending 15 to group 19000. PIDs of all processes in the group: [19000]
[2025-12-15T21:06:26.539+0000] {process_utils.py:87} INFO - Sending the signal 15 to group 19000
[2025-12-15T21:07:26.575+0000] {process_utils.py:150} WARNING - process psutil.Process(pid=19000, name='airflow task ru', status='sleeping', started='20:54:42') did not respond to SIGTERM. Trying SIGKILL
[2025-12-15T21:07:26.581+0000] {process_utils.py:87} INFO - Sending the signal 9 to group 19000
[2025-12-15T21:07:26.596+0000] {process_utils.py:80} INFO - Process psutil.Process(pid=19000, name='airflow task ru', status='terminated', exitcode=<Negsignal.SIGKILL: -9>, started='20:54:42') (19000) terminated with exit code -9
[2025-12-15T21:07:26.598+0000] {standard_task_runner.py:190} ERROR - ('Job None was killed before it finished (likely due to running out of memory)', 'For more information, see https://***.apache.org/docs/apache-***/stable/troubleshooting.html#LocalTaskJob-killed')
[2025-12-15T21:57:18.149+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-12-15T21:57:18.178+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: weather_prediction_pipeline_v2.store_daily_predictions scheduled__2025-12-14T18:05:00+00:00 [queued]>
[2025-12-15T21:57:18.196+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: weather_prediction_pipeline_v2.store_daily_predictions scheduled__2025-12-14T18:05:00+00:00 [queued]>
[2025-12-15T21:57:18.197+0000] {taskinstance.py:2865} INFO - Starting attempt 1 of 3
[2025-12-15T21:57:18.218+0000] {taskinstance.py:2888} INFO - Executing <Task(PythonOperator): store_daily_predictions> on 2025-12-14 18:05:00+00:00
[2025-12-15T21:57:18.231+0000] {standard_task_runner.py:72} INFO - Started process 359 to run task
[2025-12-15T21:57:18.237+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'weather_prediction_pipeline_v2', 'store_daily_predictions', 'scheduled__2025-12-14T18:05:00+00:00', '--job-id', '110', '--raw', '--subdir', 'DAGS_FOLDER/test_etl.py', '--cfg-path', '/tmp/tmp7xexbvzy']
[2025-12-15T21:57:18.243+0000] {standard_task_runner.py:105} INFO - Job 110: Subtask store_daily_predictions
[2025-12-15T21:57:18.278+0000] {logging_mixin.py:190} WARNING - /home/***/.local/lib/python3.10/site-packages/***/settings.py:209 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-12-15T21:57:18.363+0000] {task_command.py:467} INFO - Running <TaskInstance: weather_prediction_pipeline_v2.store_daily_predictions scheduled__2025-12-14T18:05:00+00:00 [running]> on host b89d32282382
[2025-12-15T21:57:18.366+0000] {logging_mixin.py:190} WARNING - /home/***/.local/lib/python3.10/site-packages/***/settings.py:470 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-12-15T21:57:18.486+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='ahmed_sami' AIRFLOW_CTX_DAG_ID='weather_prediction_pipeline_v2' AIRFLOW_CTX_TASK_ID='store_daily_predictions' AIRFLOW_CTX_EXECUTION_DATE='2025-12-14T18:05:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-12-14T18:05:00+00:00'
[2025-12-15T21:57:18.488+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-12-15T21:57:18.510+0000] {logging_mixin.py:190} INFO - ======================================================================
[2025-12-15T21:57:18.511+0000] {logging_mixin.py:190} INFO -                     DAY 2: STORING PREDICTIONS (BULK MODE)
[2025-12-15T21:57:18.512+0000] {logging_mixin.py:190} INFO - ======================================================================
[2025-12-15T21:57:18.533+0000] {logging_mixin.py:190} INFO - üíæ Storing 27 predictions using Bulk Insert...
[2025-12-15T21:57:18.535+0000] {logging_mixin.py:190} INFO - üìÖ Target date: 2025-12-16
[2025-12-15T21:57:18.550+0000] {base.py:84} INFO - Retrieving connection 'ml_con'
[2025-12-15T21:57:18.551+0000] {logging_mixin.py:190} INFO - üîå Connecting to database: postgres:5432
[2025-12-15T21:57:18.552+0000] {logging_mixin.py:190} INFO -    Database: ***
[2025-12-15T21:57:18.554+0000] {logging_mixin.py:190} INFO -    User: ***
[2025-12-15T21:57:18.555+0000] {logging_mixin.py:190} INFO -    Timeout: 10 seconds
[2025-12-15T21:57:18.556+0000] {logging_mixin.py:190} INFO - üîå Establishing connection...
[2025-12-15T21:57:18.565+0000] {logging_mixin.py:190} INFO - ‚úÖ Connection established!
[2025-12-15T21:57:18.567+0000] {logging_mixin.py:190} INFO - ‚úÖ Statement timeout set to 30s
[2025-12-15T21:57:18.568+0000] {logging_mixin.py:190} INFO - üìã Creating/verifying table structure...
[2025-12-15T21:57:18.570+0000] {logging_mixin.py:190} INFO - ‚úÖ Table structure verified
[2025-12-15T21:57:18.571+0000] {logging_mixin.py:190} INFO - üîß Ensuring all columns exist...
[2025-12-15T21:57:18.573+0000] {logging_mixin.py:190} INFO - ‚úÖ Columns verified
[2025-12-15T21:57:18.574+0000] {logging_mixin.py:190} INFO - üì¶ Preparing data for bulk insert...
[2025-12-15T21:57:18.575+0000] {logging_mixin.py:190} INFO - ‚úÖ Prepared 27 records
[2025-12-15T21:57:18.576+0000] {logging_mixin.py:190} INFO - üöÄ Executing bulk insert...
[2025-12-15T21:57:18.582+0000] {logging_mixin.py:190} INFO - ‚úÖ Bulk insert completed
[2025-12-15T21:57:18.584+0000] {logging_mixin.py:190} INFO - üíæ Committing transaction...
[2025-12-15T21:57:18.586+0000] {logging_mixin.py:190} INFO - ‚úÖ Transaction committed successfully!
[2025-12-15T21:57:18.587+0000] {logging_mixin.py:190} INFO - üîç Verifying insertion...
[2025-12-15T21:57:18.590+0000] {logging_mixin.py:190} INFO - ‚úÖ Verified: 27 predictions stored for 2025-12-16
[2025-12-15T21:57:18.591+0000] {logging_mixin.py:190} INFO - üîå Connection closed
[2025-12-15T21:57:18.592+0000] {logging_mixin.py:190} INFO - ======================================================================
[2025-12-15T21:57:18.594+0000] {logging_mixin.py:190} INFO - ‚úÖ store_daily_predictions COMPLETED SUCCESSFULLY
[2025-12-15T21:57:18.595+0000] {logging_mixin.py:190} INFO - ======================================================================
[2025-12-15T21:57:18.596+0000] {python.py:240} INFO - Done. Returned value was: None
[2025-12-15T21:57:18.612+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-12-15T21:57:18.613+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=weather_prediction_pipeline_v2, task_id=store_daily_predictions, run_id=scheduled__2025-12-14T18:05:00+00:00, execution_date=20251214T180500, start_date=20251215T215718, end_date=20251215T215718
[2025-12-15T21:57:18.651+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-12-15T21:57:18.676+0000] {taskinstance.py:3900} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-12-15T21:57:18.680+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
[2025-12-15T22:34:16.752+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-12-15T22:34:16.777+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: weather_prediction_pipeline_v2.store_daily_predictions scheduled__2025-12-14T18:05:00+00:00 [queued]>
[2025-12-15T22:34:16.787+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: weather_prediction_pipeline_v2.store_daily_predictions scheduled__2025-12-14T18:05:00+00:00 [queued]>
[2025-12-15T22:34:16.789+0000] {taskinstance.py:2865} INFO - Starting attempt 1 of 3
[2025-12-15T22:34:16.803+0000] {taskinstance.py:2888} INFO - Executing <Task(PythonOperator): store_daily_predictions> on 2025-12-14 18:05:00+00:00
[2025-12-15T22:34:16.813+0000] {standard_task_runner.py:72} INFO - Started process 1287 to run task
[2025-12-15T22:34:16.817+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'weather_prediction_pipeline_v2', 'store_daily_predictions', 'scheduled__2025-12-14T18:05:00+00:00', '--job-id', '15', '--raw', '--subdir', 'DAGS_FOLDER/test_etl.py', '--cfg-path', '/tmp/tmp4ru6b3ry']
[2025-12-15T22:34:16.822+0000] {standard_task_runner.py:105} INFO - Job 15: Subtask store_daily_predictions
[2025-12-15T22:34:16.847+0000] {logging_mixin.py:190} WARNING - /home/***/.local/lib/python3.10/site-packages/***/settings.py:209 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-12-15T22:34:16.909+0000] {task_command.py:467} INFO - Running <TaskInstance: weather_prediction_pipeline_v2.store_daily_predictions scheduled__2025-12-14T18:05:00+00:00 [running]> on host 6f17979d182d
[2025-12-15T22:34:16.912+0000] {logging_mixin.py:190} WARNING - /home/***/.local/lib/python3.10/site-packages/***/settings.py:470 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-12-15T22:34:17.033+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='ahmed_sami' AIRFLOW_CTX_DAG_ID='weather_prediction_pipeline_v2' AIRFLOW_CTX_TASK_ID='store_daily_predictions' AIRFLOW_CTX_EXECUTION_DATE='2025-12-14T18:05:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-12-14T18:05:00+00:00'
[2025-12-15T22:34:17.034+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-12-15T22:34:17.058+0000] {logging_mixin.py:190} INFO - ======================================================================
[2025-12-15T22:34:17.059+0000] {logging_mixin.py:190} INFO -                     DAY 2: STORING PREDICTIONS (BULK MODE)
[2025-12-15T22:34:17.060+0000] {logging_mixin.py:190} INFO - ======================================================================
[2025-12-15T22:34:17.087+0000] {logging_mixin.py:190} INFO - üíæ Storing 64 predictions using Bulk Insert...
[2025-12-15T22:34:17.088+0000] {logging_mixin.py:190} INFO - üìÖ Target date: 2025-12-16
[2025-12-15T22:34:17.107+0000] {base.py:84} INFO - Retrieving connection 'ml_con'
[2025-12-15T22:34:17.109+0000] {logging_mixin.py:190} INFO - üîå Connecting to database: postgres:5432
[2025-12-15T22:34:17.110+0000] {logging_mixin.py:190} INFO -    Database: ***
[2025-12-15T22:34:17.111+0000] {logging_mixin.py:190} INFO -    User: ***
[2025-12-15T22:34:17.112+0000] {logging_mixin.py:190} INFO -    Timeout: 10 seconds
[2025-12-15T22:34:17.113+0000] {logging_mixin.py:190} INFO - üîå Establishing connection...
[2025-12-15T22:34:17.122+0000] {logging_mixin.py:190} INFO - ‚úÖ Connection established!
[2025-12-15T22:34:17.124+0000] {logging_mixin.py:190} INFO - ‚úÖ Statement timeout set to 30s
[2025-12-15T22:34:17.125+0000] {logging_mixin.py:190} INFO - üìã Creating/verifying table structure...
[2025-12-15T22:34:17.136+0000] {logging_mixin.py:190} INFO - ‚úÖ Table structure verified
[2025-12-15T22:34:17.137+0000] {logging_mixin.py:190} INFO - üîß Ensuring all columns exist...
[2025-12-15T22:34:17.139+0000] {logging_mixin.py:190} INFO - ‚úÖ Columns verified
[2025-12-15T22:34:17.140+0000] {logging_mixin.py:190} INFO - üì¶ Preparing data for bulk insert...
[2025-12-15T22:34:17.141+0000] {logging_mixin.py:190} INFO - ‚úÖ Prepared 64 records
[2025-12-15T22:34:17.142+0000] {logging_mixin.py:190} INFO - üöÄ Executing bulk insert...
[2025-12-15T22:34:17.150+0000] {logging_mixin.py:190} INFO - ‚úÖ Bulk insert completed
[2025-12-15T22:34:17.151+0000] {logging_mixin.py:190} INFO - üíæ Committing transaction...
[2025-12-15T22:34:17.153+0000] {logging_mixin.py:190} INFO - ‚úÖ Transaction committed successfully!
[2025-12-15T22:34:17.154+0000] {logging_mixin.py:190} INFO - üîç Verifying insertion...
[2025-12-15T22:34:17.157+0000] {logging_mixin.py:190} INFO - ‚úÖ Verified: 64 predictions stored for 2025-12-16
[2025-12-15T22:34:17.158+0000] {logging_mixin.py:190} INFO - üîå Connection closed
[2025-12-15T22:34:17.159+0000] {logging_mixin.py:190} INFO - ======================================================================
[2025-12-15T22:34:17.160+0000] {logging_mixin.py:190} INFO - ‚úÖ store_daily_predictions COMPLETED SUCCESSFULLY
[2025-12-15T22:34:17.161+0000] {logging_mixin.py:190} INFO - ======================================================================
[2025-12-15T22:34:17.162+0000] {python.py:240} INFO - Done. Returned value was: None
[2025-12-15T22:34:17.184+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-12-15T22:34:17.185+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=weather_prediction_pipeline_v2, task_id=store_daily_predictions, run_id=scheduled__2025-12-14T18:05:00+00:00, execution_date=20251214T180500, start_date=20251215T223416, end_date=20251215T223417
[2025-12-15T22:34:17.233+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-12-15T22:34:17.259+0000] {taskinstance.py:3900} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-12-15T22:34:17.262+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
[2025-12-16T14:41:21.118+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-12-16T14:41:21.149+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: weather_prediction_pipeline_v2.store_daily_predictions scheduled__2025-12-14T18:05:00+00:00 [queued]>
[2025-12-16T14:41:21.159+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: weather_prediction_pipeline_v2.store_daily_predictions scheduled__2025-12-14T18:05:00+00:00 [queued]>
[2025-12-16T14:41:21.160+0000] {taskinstance.py:2865} INFO - Starting attempt 1 of 3
[2025-12-16T14:41:21.175+0000] {taskinstance.py:2888} INFO - Executing <Task(PythonOperator): store_daily_predictions> on 2025-12-14 18:05:00+00:00
[2025-12-16T14:41:21.184+0000] {standard_task_runner.py:72} INFO - Started process 15748 to run task
[2025-12-16T14:41:21.190+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'weather_prediction_pipeline_v2', 'store_daily_predictions', 'scheduled__2025-12-14T18:05:00+00:00', '--job-id', '142', '--raw', '--subdir', 'DAGS_FOLDER/test_etl.py', '--cfg-path', '/tmp/tmp6vd80c9q']
[2025-12-16T14:41:21.193+0000] {standard_task_runner.py:105} INFO - Job 142: Subtask store_daily_predictions
[2025-12-16T14:41:21.216+0000] {logging_mixin.py:190} WARNING - /home/***/.local/lib/python3.10/site-packages/***/settings.py:209 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-12-16T14:41:21.275+0000] {task_command.py:467} INFO - Running <TaskInstance: weather_prediction_pipeline_v2.store_daily_predictions scheduled__2025-12-14T18:05:00+00:00 [running]> on host 15d037495a80
[2025-12-16T14:41:21.278+0000] {logging_mixin.py:190} WARNING - /home/***/.local/lib/python3.10/site-packages/***/settings.py:470 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-12-16T14:41:21.401+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='ahmed_sami' AIRFLOW_CTX_DAG_ID='weather_prediction_pipeline_v2' AIRFLOW_CTX_TASK_ID='store_daily_predictions' AIRFLOW_CTX_EXECUTION_DATE='2025-12-14T18:05:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-12-14T18:05:00+00:00'
[2025-12-16T14:41:21.403+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-12-16T14:41:21.423+0000] {logging_mixin.py:190} INFO - ======================================================================
[2025-12-16T14:41:21.425+0000] {logging_mixin.py:190} INFO -                     DAY 2: STORING PREDICTIONS (OPTIMIZED)
[2025-12-16T14:41:21.426+0000] {logging_mixin.py:190} INFO - ======================================================================
[2025-12-16T14:41:21.451+0000] {logging_mixin.py:190} INFO - üíæ Storing 62 predictions...
[2025-12-16T14:41:21.453+0000] {logging_mixin.py:190} INFO - üìÖ Target date: 2025-12-17
[2025-12-16T14:41:21.468+0000] {base.py:84} INFO - Retrieving connection 'ml_con'
[2025-12-16T14:41:21.469+0000] {logging_mixin.py:190} INFO - üîå Connecting...
[2025-12-16T14:41:21.477+0000] {logging_mixin.py:190} INFO - ‚úÖ Connected!
[2025-12-16T14:41:21.479+0000] {logging_mixin.py:190} INFO - üìã Ensuring table exists...
[2025-12-16T14:41:21.482+0000] {logging_mixin.py:190} INFO - ‚úÖ Table ready
[2025-12-16T14:41:21.483+0000] {logging_mixin.py:190} INFO - üîç Checking for existing records on 2025-12-17...
[2025-12-16T14:41:21.485+0000] {logging_mixin.py:190} INFO - ‚ö†Ô∏è  Found 64 existing records for 2025-12-17
[2025-12-16T14:41:21.487+0000] {logging_mixin.py:190} INFO -    Cities: Latakia, Jerusalem, Giza, Buraydah, Isfahan, Salalah, Cairo, Tel Aviv, Sanaa, Gaza, Hurghada, Manama, Abu Dhabi, Muscat, Suez, Tabriz, Alexandria, Khobar, Damascus, Hebron, Qom, Taif, Mashhad, Konya, Homs, Basra, Irbid, Gaziantep, Dubai, Ismailia, Tehran, Mosul, Amman, Baghdad, Aleppo, Adana, Zarqa, Dammam, Kuwait City, Ankara, Sharm El Sheikh, Izmir, Istanbul, Erbil, Najaf, Antalya, Doha, Riyadh, Al Ain, Beirut, Mecca, Nablus, Sharjah, Haifa, Medina, Aswan, Port Said, Aden, Shiraz, East Jerusalem, Tabuk, Abha, Jeddah, Luxor
[2025-12-16T14:41:21.488+0000] {logging_mixin.py:190} INFO - üîÑ Updating 62 existing records...
[2025-12-16T14:41:21.495+0000] {logging_mixin.py:190} INFO - ‚úÖ Updated 62 records
[2025-12-16T14:41:21.499+0000] {logging_mixin.py:190} INFO - 
üéâ Success! Total processed: 62 predictions
[2025-12-16T14:41:21.500+0000] {logging_mixin.py:190} INFO -    - Updated: 62
[2025-12-16T14:41:21.501+0000] {logging_mixin.py:190} INFO -    - Inserted: 0
[2025-12-16T14:41:21.502+0000] {logging_mixin.py:190} INFO - ======================================================================
[2025-12-16T14:41:21.503+0000] {python.py:240} INFO - Done. Returned value was: None
[2025-12-16T14:41:21.518+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-12-16T14:41:21.520+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=weather_prediction_pipeline_v2, task_id=store_daily_predictions, run_id=scheduled__2025-12-14T18:05:00+00:00, execution_date=20251214T180500, start_date=20251216T144121, end_date=20251216T144121
[2025-12-16T14:41:21.564+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-12-16T14:41:21.588+0000] {taskinstance.py:3900} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-12-16T14:41:21.591+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
